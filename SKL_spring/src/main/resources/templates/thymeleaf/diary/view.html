<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/thymeleaf/default_layout}">
<th:block layout:fragment="css">
	<link rel="stylesheet" href="/css/diary/diary-view.css">
</th:block>

<body>
<div class="main-content" layout:fragment="content">
	<!-- title -->
	<div class="title-section">
		<span class="memberid" th:text="${diary.memberId}">ì•„ì´ë””</span>
		<img src="/img/journal/diary-sjournal.png" class="diary-journal" />
	</div>

	<div class="content-wrapper">

		<div class="content-section">
		<!-- ğŸ“Œ ìº˜ë¦°ë” ì»¨í…Œì´ë„ˆ -->
			<div class="calendar-section">
            	<div id="calendar-container">
        			<!-- ë“œë¡­ë‹¤ìš´ ì»¨íŠ¸ë¡¤ -->
        			<div id="controls">
            			<select id="year-select"></select>
            			<select id="month-select">
                			<option value="0">January</option>
                			<option value="1">February</option>
                			<option value="2">March</option>
                			<option value="3">April</option>
                			<option value="4">May</option>
                			<option value="5">June</option>
                			<option value="6">July</option>
                			<option value="7">August</option>
                			<option value="8">September</option>
                			<option value="9">October</option>
                			<option value="10">November</option>
                			<option value="11">December</option>
            			</select>
        			</div>
			
					<!-- ìº˜ë¦°ë” -->
        			<div id="calendar"></div>
    			</div>
			</div>
		</div>

		<div class="diary-button-section">
			<div class="diary-section">
				<!-- <img src="/img/journal/diary_read.png" class="diary_book" /> -->
				<!-- ì¼ê¸° ì œëª© & ë‚ ì§œ -->
				<div class="diary-container">
					<div class="diary-header" id="diary-header">
						<p th:text="${diary.diaryTitle}"></p>
					</div>
					<div class="diary-date">
						<p class="diary-date">DATE:
							<span id="diary-date"
								  th:text="${diary.diaryDate != null ? diary.diaryDate.substring(0,10) : 'ë‚ ì§œ ì—†ìŒ'}"></span>
						</p>
					</div>

					<!-- ì¼ê¸° ë‚´ìš© -->
					<div class="diary-content">
						<p th:utext="${diary.diaryContent}"></p>
						<!-- ì²¨ë¶€íŒŒì¼ì´ ì¡´ì¬í•  ê²½ìš° -->
						<div class="attach-file" th:if="${attach != null}">
							<!-- íŒŒì¼ í™•ì¥ì í™•ì¸ -->
							<div th:with="extension=${attach.getFileExtension()}">

								<!-- ì´ë¯¸ì§€ íŒŒì¼ì¸ ê²½ìš° -->
								<div th:if="${extension == 'jpg' or extension == 'jpeg' or extension == 'png' or extension == 'gif'}">
									<img th:src="@{/attach/{fileName}(fileName=${attach.attachName})}" alt="ì²¨ë¶€ ì´ë¯¸ì§€"/>
								</div>

								<!-- ê¸°íƒ€ íŒŒì¼ì¸ ê²½ìš° -->
								<div th:unless="${extension == 'jpg' or extension == 'jpeg' or extension == 'png' or extension == 'gif'}">
									<a th:href="@{/attach/{fileName}(fileName=${attach.attachName})}"
									   th:text="${attach.attachName}" download>
										<button>ğŸ“¥ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- í”¼ë“œë°± -->
				<div class="feed-container">
					<h3 id="diaryEmotion" th:text="${diary.diaryEmotion != null ? diary.diaryEmotion : 'â³ í”¼ë“œë°±ì„ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...'}"></h3>
					<p id="diaryFeedback" th:text="${diary.diaryEmotion}?:'ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”...'"></p>
				</div>
			</div>

			<!-- ë²„íŠ¼ -->
			<div class="update-delete-container">
				<button class="update-btn" th:onclick="|location.href='@{/diary/update(diaryId=${diary.diaryId})}'|">ìˆ˜ì •</button>
				<button class="delete-btn" th:onclick="|if(confirm('ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) { location.href='@{/diary/delete(diaryId=${diary.diaryId})}'; }|">ì‚­ì œ</button>
			</div>
		</div>
	</div>
</div>

<th:block layout:fragment="script">
	<!-- FullCalendar JS -->
	<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.8/index.global.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@6.1.8/index.global.min.js"></script>

	<!-- Custom JS -->
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			const calendarEl = document.getElementById('calendar');

			// FullCalendar ì´ˆê¸°í™”
			const calendar = new FullCalendar.Calendar(calendarEl, {
				initialView: 'dayGridMonth',
				locale: 'en', // ì˜ì–´ ì„¤ì •
				headerToolbar: false, // ê¸°ë³¸ í—¤ë” íˆ´ë°” ì œê±°
				dayHeaderContent: (args) => args.text.substr(0, 3), // ìš”ì¼ ì´ë¦„ì„ ì• ì„¸ ê¸€ìë¡œ í‘œì‹œ
				events: [], // ì´ë²¤íŠ¸ ì—†ìŒ
				aspectRatio: 1.35, // ê¸°ì¡´ë³´ë‹¤ ë„“ì–´ì§€ê²Œ ì¡°ì •
				contentHeight: 'auto' // ìë™ ë†’ì´ ì¡°ì •
			});

			calendar.render();

			// ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™”
			const yearSelect = document.getElementById('year-select');
			const monthSelect = document.getElementById('month-select');

			const currentYear = new Date().getFullYear();

			// ë…„ë„ ë“œë¡­ë‹¤ìš´ ì±„ìš°ê¸° (í˜„ì¬ ë…„ë„ ê¸°ì¤€ Â±5ë…„)
			for (let i = currentYear - 5; i <= currentYear + 5; i++) {
				const option = document.createElement('option');
				option.value = i;
				option.textContent = `${i} ë…„`;
				if (i === currentYear) option.selected = true; // í˜„ì¬ ë…„ë„ ì„ íƒ
				yearSelect.appendChild(option);
			}

			// ì›” ë“œë¡­ë‹¤ìš´ ì´ˆê¸°ê°’ ì„¤ì •
			monthSelect.value = new Date().getMonth();

			// ë“œë¡­ë‹¤ìš´ ë³€ê²½ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
			function updateCalendar() {
				const selectedYear = parseInt(yearSelect.value);
				const selectedMonth = parseInt(monthSelect.value);

				// ì„ íƒëœ ë…„ë„ì™€ ì›”ë¡œ ì´ë™
				calendar.gotoDate(new Date(selectedYear, selectedMonth));
			}

			yearSelect.addEventListener('change', updateCalendar);
			monthSelect.addEventListener('change', updateCalendar);

			const diaryEmotion = document.getElementById("diaryEmotion");
			const diaryFeedback = document.getElementById("diaryFeedback");
			const feedContainer = document.querySelector(".feed-container");

			switch (diaryEmotion.textContent) {
				case "ê¸°ì¨":
					// message = "ì˜¤ëŠ˜ ì •ë§ ì¢‹ì€ í•˜ë£¨ì˜€êµ°ìš”! ì´ í–‰ë³µí•œ ìˆœê°„ì´ ì˜¤ë˜ë„ë¡ ê¸°ì–µì— ë‚¨ê¸¸ ë°”ë¼ìš”. ğŸ’›"
					message = "ì˜¤ëŠ˜ ì •ë§ ì¢‹ì€ ì¼ì´ ìˆì—ˆêµ°ìš”! ì´ëŸ° ìˆœê°„ë“¤ì€ ì‚¶ì„ ë” ë¹›ë‚˜ê²Œ ë§Œë“¤ì–´ ì£¼ì£ . ê¸°ì¨ì„ ì¶©ë¶„íˆ ë§Œë½í•˜ê³ , ë‚˜ì¤‘ì— ëŒì•„ë´¤ì„ ë•Œë„ ì›ƒì„ ìˆ˜ ìˆë„ë¡ ì†Œì¤‘í•œ ê¸°ì–µìœ¼ë¡œ ë‚¨ê²¨ë³´ì„¸ìš”. ì´ í–‰ë³µí•œ ê¸°ìš´ì´ ì˜¤ë˜ë„ë¡ ì´ì–´ì§€ê¸¸ ë°”ë¼ìš”! ğŸ’›";
					feedContainer.style.backgroundColor = "#edd2d2";
					break;
				case "ìŠ¬í””":
					// message = "í˜ë“  ìˆœê°„ì´ì§€ë§Œ, ì´ ë˜í•œ ì§€ë‚˜ê°ˆ ê±°ì˜ˆìš”. ë‹¹ì‹ ì˜ ë§ˆìŒì´ ì¡°ê¸ˆì´ë¼ë„ í¸í•´ì§€ê¸¸ ë°”ë¼ìš”. ğŸ’™"
					message = "ë§ˆìŒì´ ë§ì´ í˜ë“¤ì—ˆê² ì–´ìš”. í•˜ì§€ë§Œ ì–´ë–¤ ê°ì •ì´ë“  ìš°ë¦¬ì—ê²Œ í•„ìš”í•œ ìˆœê°„ì´ ìˆì–´ìš”. ì¶©ë¶„íˆ ìŠ¬í¼í•˜ê³ , ìŠ¤ìŠ¤ë¡œë¥¼ ìœ„ë¡œí•´ ì£¼ì„¸ìš”. í˜¼ìê°€ ì•„ë‹ˆë¼ëŠ” ê±¸ ìŠì§€ ë§ˆì„¸ìš”. ë‹¹ì‹ ì˜ ë§ˆìŒì´ ì ì  ë”°ëœ»í•´ì§€ê³ , í˜ë“  ìˆœê°„ì„ ì˜ ì§€ë‚˜ê°ˆ ìˆ˜ ìˆê¸¸ ì§„ì‹¬ìœ¼ë¡œ ì‘ì›í• ê²Œìš”. ğŸ’™";
					feedContainer.style.backgroundColor = "#edd2d2";
					break;
				case "ë¶„ë…¸":
					// message = "ì†ìƒí•˜ê³  ì–µìš¸í•œ ì¼ì´ ìˆì—ˆë‚˜ ë³´ë„¤ìš”. ê°ì •ì„ ì†”ì§í•˜ê²Œ í‘œí˜„í•˜ëŠ” ê±´ ì¤‘ìš”í•´ìš”. ì¡°ê¸ˆë§Œ ë§ˆìŒì„ ê°€ë¼ì•‰íˆê³  ìŠ¤ìŠ¤ë¡œë¥¼ ë‹¤ë…ì—¬ ë³´ì„¸ìš”. ğŸ’œ";
					message = "ì •ë§ ì†ìƒí•˜ê³  í™”ê°€ ë‚¬ê² ì–´ìš”. ë•Œë¡œëŠ” ê°ì •ì„ ë“œëŸ¬ë‚´ëŠ” ê²ƒë„ í•„ìš”í•œ ë²•ì´ì£ . í•˜ì§€ë§Œ ê·¸ ê°ì •ì— íœ©ì“¸ë¦¬ê¸°ë³´ë‹¤ëŠ”, ì°¨ë¶„í•˜ê²Œ ì •ë¦¬í•´ ë³´ë©´ ë‚˜ë¥¼ ë” ì§€í‚¤ëŠ” ë°©ë²•ì„ ì°¾ì„ ìˆ˜ë„ ìˆì„ ê±°ì˜ˆìš”. ë‹¹ì‹ ì˜ ê°ì •ì€ ì†Œì¤‘í•˜ê³  ì •ë‹¹í•œ ê²ƒì´ë‹ˆ, ì²œì²œíˆ ë‹¤ë…ì´ë©° ì¢‹ì€ ë°©í–¥ìœ¼ë¡œ í’€ì–´ë‚˜ê°€ê¸¸ ë°”ë¼ìš”.";
					feedContainer.style.backgroundColor = "#edd2d2";
					break;
				case "ë¶ˆì•ˆ":
					// message = ë¶ˆì•ˆí•œ ë§ˆìŒì´ ë“¤ ë•ŒëŠ” ê¹Šê²Œ ìˆ¨ì„ ì‰¬ê³ , ì§€ê¸ˆ í•  ìˆ˜ ìˆëŠ” ê²ƒì— ì§‘ì¤‘í•´ ë³´ì„¸ìš”. ë‹¹ì‹ ì€ ì¶©ë¶„íˆ ì˜í•´ë‚´ê³  ìˆì–´ìš”! ğŸ’š";
					message = "ë¶ˆì•ˆí•œ ë§ˆìŒì´ ë“¤ ë•ŒëŠ” ì •ë§ ì•„ë¬´ê²ƒë„ ì†ì— ì¡íˆì§€ ì•Šì„ ë•Œê°€ ë§ì£ . í•˜ì§€ë§Œ ì§€ê¸ˆ ì´ ìˆœê°„ì—ë„ ë‹¹ì‹ ì€ ì˜ í•´ë‚´ê³  ìˆì–´ìš”. ì‘ì€ ê²ƒë¶€í„° í•˜ë‚˜ì”© í•´ê²°í•´ ë‚˜ê°€ë‹¤ ë³´ë©´ ì–´ëŠìƒˆ ë¶ˆì•ˆí•¨ë„ ì¡°ê¸ˆì”© ì˜…ì–´ì§ˆ ê±°ì˜ˆìš”. ë¬´ì—‡ë³´ë‹¤ ìŠ¤ìŠ¤ë¡œë¥¼ ë„ˆë¬´ ëª°ì•„ë¶™ì´ì§€ ë§ê³ , ì¶©ë¶„íˆ ì‰¬ì–´ê°€ë©° ë‚˜ì•„ê°€ê¸¸ ë°”ë¼ìš”. ë‹¹ì‹ ì€ ë¶„ëª… ì¢‹ì€ ë°©í–¥ìœ¼ë¡œ ê°€ê³  ìˆì–´ìš”! ğŸ’š";
					feedContainer.style.backgroundColor = "#edd2d2";
					break;
				case "ë‹¹í™©":
					// message = "ì˜ˆìƒì¹˜ ëª»í•œ ì¼ì´ ìˆì—ˆêµ°ìš”! í•˜ì§€ë§Œ ì´ëŸ° ê²½í—˜ì´ ìš°ë¦¬ë¥¼ ë” ìœ ì—°í•˜ê³  ì§€í˜œë¡­ê²Œ ë§Œë“¤ì–´ ì¤€ë‹µë‹ˆë‹¤. ê´œì°®ì•„ìš”! ğŸ’›";
					message = "ì˜ˆìƒì¹˜ ëª»í•œ ì¼ì´ ìƒê¸°ë©´ ìˆœê°„ì ìœ¼ë¡œ ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ë§‰ë§‰í•  ë•Œê°€ ìˆì£ . í•˜ì§€ë§Œ ì´ëŸ° ê²½í—˜ë“¤ì´ ìŒ“ì´ë©´ ì ì  ë” ìœ ì—°í•˜ê³  ì§€í˜œë¡œìš´ ì‚¬ëŒì´ ë˜ì–´ê°ˆ ê±°ì˜ˆìš”. ì²˜ìŒì—” ë‹¹í™©ìŠ¤ëŸ½ê² ì§€ë§Œ, ì§€ê¸ˆì˜ ê²½í—˜ì´ ë‚˜ì¤‘ì—ëŠ” í•˜ë‚˜ì˜ ì´ì•¼ê¸°ë¡œ ë‚¨ì„ ìˆ˜ë„ ìˆì–´ìš”. ë„ˆë¬´ ìì±…í•˜ì§€ ë§ê³ , ì˜¤ëŠ˜ë„ ì¶©ë¶„íˆ ì˜í•´ëƒˆë‹¤ëŠ” ê±¸ ê¸°ì–µí•˜ì„¸ìš”! ğŸ’›";
					feedContainer.style.backgroundColor = "#edd2d2";
					break;
				case "ìƒì²˜":
					// message = "ë§ˆìŒì´ ì•„í”ˆ ì¼ì´ ìˆì—ˆë‚˜ ë´ìš”. í•˜ì§€ë§Œ ë‹¹ì‹ ì˜ ê°€ì¹˜ëŠ” ë³€í•˜ì§€ ì•Šì•„ìš”. ì¶©ë¶„íˆ ì†Œì¤‘í•œ ì‚¬ëŒì´ë‹ˆê¹Œìš”. ğŸ’–";
					message = "ë§ˆìŒì´ ë§ì´ ì•„íŒ ê² ì–´ìš”. ë•Œë•Œë¡œ ìš°ë¦¬ëŠ” ë‹¤ë¥¸ ì‚¬ëŒì˜ ë§ì´ë‚˜ í–‰ë™ì— ìƒì²˜ë¥¼ ë°›ê¸°ë„ í•˜ì§€ë§Œ, ê·¸ ëˆ„êµ¬ë„ ë‹¹ì‹ ì˜ ê°€ì¹˜ë¥¼ ê²°ì •í•  ìˆ˜ ì—†ì–´ìš”. ë‹¹ì‹ ì€ ì†Œì¤‘í•˜ê³ , ê·¸ ìì²´ë¡œ ì¶©ë¶„íˆ ë¹›ë‚˜ëŠ” ì‚¬ëŒì´ì—ìš”. ìƒì²˜ë°›ì€ ë§ˆìŒì´ ì²œì²œíˆ íšŒë³µë  ìˆ˜ ìˆë„ë¡ ìŠ¤ìŠ¤ë¡œë¥¼ ì•„ê»´ ì£¼ì„¸ìš”. ê·¸ë¦¬ê³  ê¼­ ê¸°ì–µí•˜ì„¸ìš”, ë‹¹ì‹ ì€ ì‚¬ë‘ë°›ì„ ìê²©ì´ ìˆëŠ” ì¡´ì¬ëë‹ˆë‹¤. ğŸ’–";
					feedContainer.style.backgroundColor = "#edd2d2";
					break;
				default:
					// message = "í‰ì˜¨í•œ í•˜ë£¨ë¥¼ ë³´ëƒˆêµ°ìš”. ì´ëŸ° ì¼ìƒì´ ìŒ“ì´ë©´ ë§ˆìŒë„ í•œê²° í¸ì•ˆí•´ì§ˆ ê±°ì˜ˆìš”. ì˜¤ëŠ˜ë„ ìˆ˜ê³  ë§ì•˜ì–´ìš”! ğŸ¤";
					message = "ë¬´ë‚œí•œ í•˜ë£¨ë¥¼ ë³´ë‚´ì…¨ë‚˜ìš”? ë•Œë¡œëŠ” ì´ëŸ° í‰ë²”í•œ ë‚ ë“¤ì´ ê°€ì¥ ì†Œì¤‘í•œ ìˆœê°„ì´ ë˜ê¸°ë„ í•´ìš”. ì¡°ìš©í•œ í•˜ë£¨ ì†ì—ì„œë„ ì‘ì€ í–‰ë³µì„ ì°¾ì•„ë³´ëŠ” ê±´ ì–´ë–¨ê¹Œìš”? ì¢‹ì•„í•˜ëŠ” ìŒì•…ì„ ë“£ê±°ë‚˜, ë”°ëœ»í•œ ì°¨ í•œ ì”ì„ ë§ˆì‹œë©´ì„œ ìŠ¤ìŠ¤ë¡œì—ê²Œ ì‘ì€ íœ´ì‹ì„ ì„ ë¬¼í•´ ë³´ì„¸ìš”. ì˜¤ëŠ˜ë„ ìˆ˜ê³  ë§ì•˜ì–´ìš”! ğŸ¤";
					feedContainer.style.backgroundColor = "#ebebeb";
					break;
			}
			diaryFeedback.textContent = message;
		});
	</script>
	<!--
	<script>
		document.addEventListener("DOMContentLoaded", function() {
			const diaryFeedback = document.getElementById("diaryFeedback");

			// ë§Œì•½ ë°±ì—”ë“œì—ì„œ ë°ì´í„°ë¥¼ ì•„ì§ ì œê³µí•˜ì§€ ì•Šì•˜ë‹¤ë©´, ë¡œë”© ì•ŒëŸ¿ í‘œì‹œ
			if (diaryFeedback.textContent.includes("í”¼ë“œë°±ì„ ìƒì„± ì¤‘ì…ë‹ˆë‹¤")) {
				alert("í”¼ë“œë°±ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”...");
			}
		});
	</script>
	-->
</th:block>
</body>
</html>