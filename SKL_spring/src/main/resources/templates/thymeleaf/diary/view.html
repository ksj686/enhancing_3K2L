<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/thymeleaf/default_layout}">
<head>
	<link rel="stylesheet" href="/css/diary/diary-view.css">
	<title>JOURNIVERSE | DIARY</title>
</head>

<body>
<div class="main-content" layout:fragment="content">

	<div class="content-wrapper">
		<!-- title -->
		<div class="title-section">
			<span class="memberid" th:text="${diary.memberId}">ì•„ì´ë””</span>
			<span class="text">ì˜</span>
			<select class="year-selector">
				<option>2025ë…„</option>
			</select>
			<span class="journal-text">Journal</span>
		</div>
		
		<div class="diary-section">
			<!-- <img src="/img/journal/diary_read.png" class="diary_book" /> -->
			<!-- ì¼ê¸° ì œëª© & ë‚ ì§œ -->
			<div class="diary-container">
				<div class="diary-header" id="diary-header">
					<h3 th:text="${diary.diaryTitle}"></h3>
					<span class="diary-date" th:text="${diary.diaryDate != null ? diary.diaryDate.substring(0,10) : 'ë‚ ì§œ ì—†ìŒ'}"></span>
				</div>
			
				<!-- ì¼ê¸° ë‚´ìš© -->
				<div class="diary-content">
					<p th:utext="${diary.diaryContent}"></p>
					<!-- ì²¨ë¶€íŒŒì¼ì´ ì¡´ì¬í•  ê²½ìš° -->
					<div class="attach-file" th:if="${attach != null}">
    					<!-- íŒŒì¼ í™•ì¥ì í™•ì¸ -->
    					<div th:with="extension=${attach.getFileExtension()}">
        
        					<!-- ì´ë¯¸ì§€ íŒŒì¼ì¸ ê²½ìš° -->
        					<div th:if="${extension == 'jpg' or extension == 'jpeg' or extension == 'png' or extension == 'gif'}">
            					<img th:src="@{/attach/{fileName}(fileName=${attach.attachName})}" alt="ì²¨ë¶€ ì´ë¯¸ì§€" />
        					</div>

        					<!-- ê¸°íƒ€ íŒŒì¼ì¸ ê²½ìš° -->
        					<div th:unless="${extension == 'jpg' or extension == 'jpeg' or extension == 'png' or extension == 'gif'}">
            					<a th:href="@{/attach/{fileName}(fileName=${attach.attachName})}" 
               						th:text="${attach.attachName}" download>
                				<button>ğŸ“¥ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
            					</a>
        					</div>
    					</div>
					</div>
				</div>			
			</div>
		
					
			<!-- í”¼ë“œë°± -->
			<div class="feed-container" id="diaryFeedback">
				<h3 th:text="${diary.diaryEmotion != null ? diary.diaryEmotion : 'â³ í”¼ë“œë°±ì„ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...'}"></h3>
    			<p th:text="${diary.diaryFeed != null ? diary.diaryFeed : 'ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”...'}"></p>
			</div>
		
			<script>
    			document.addEventListener("DOMContentLoaded", function() {
        			const diaryFeedback = document.getElementById("diaryFeedback");

        			// ë§Œì•½ ë°±ì—”ë“œì—ì„œ ë°ì´í„°ë¥¼ ì•„ì§ ì œê³µí•˜ì§€ ì•Šì•˜ë‹¤ë©´, ë¡œë”© ì•ŒëŸ¿ í‘œì‹œ
        			if (diaryFeedback.textContent.includes("í”¼ë“œë°±ì„ ìƒì„± ì¤‘ì…ë‹ˆë‹¤")) {
            			alert("í”¼ë“œë°±ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”...");
        			}
    			});
			</script>
		</div>
		
		<!-- ë²„íŠ¼ -->
		<div class="update-delete-container">
			<button class="update-btn" th:onclick="|location.href='@{/diary/update(diaryId=${diary.diaryId})}'|">ìˆ˜ì •</button>
			<button class="delete-btn" th:onclick="|if(confirm('ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) { location.href='@{/diary/delete(diaryId=${diary.diaryId})}'; }|">ì‚­ì œ</button>
		</div>
	</div>
</div>
</body>


</html>