<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/thymeleaf/default_layout}">
<th:block layout:fragment="css">
	<link rel="stylesheet" href="/css/diary/diary-home.css"/>
    <!-- âœ… FullCalendar CSS -->
    <link href="https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.8/index.global.min.css" rel="stylesheet">
</th:block>
<body>
<div class="main-content" layout:fragment="content">
    <div class="container">

        <div class="content">
            <!-- ì™¼ìª½: ë‹¤ì´ì–´ë¦¬ í…ìŠ¤íŠ¸ -->
        	<div class="text-section">
            	<div class="diary-text">
            		<img src="/img/journal/diary-text.png" alt="I decide my own feelings. Today, it's going to be happiness." />
            	</div>
            	<div class="btn-container">
                	<a th:href="@{/diary/insert}" class="btn write-btn">Write Journal</a>
                    <a th:href="@{/diary/list}" id="readJournalBtn" class="btn read-btn">Read Journal</a>
            	</div>
        	</div>
			
			<!-- ğŸ“Œ ìº˜ë¦°ë” ì»¨í…Œì´ë„ˆ -->
			<div id="calendar-container">
				<!-- ë“œë¡­ë‹¤ìš´ ì»¨íŠ¸ë¡¤ -->
				<div id="controls">
					<select id="year-select"></select>
					<select id="month-select">
						<option value="0">January</option>
						<option value="1">February</option>
						<option value="2">March</option>
						<option value="3">April</option>
						<option value="4">May</option>
						<option value="5">June</option>
						<option value="6">July</option>
						<option value="7">August</option>
						<option value="8">September</option>
						<option value="9">October</option>
						<option value="10">November</option>
						<option value="11">December</option>
					</select>
				</div>

				<!-- ìº˜ë¦°ë” -->
				<div id="calendar"></div>

			</div>
		</div>
	</div>
</div>

<th:block layout:fragment="script">
	<!-- FullCalendar JS -->
	<!-- âœ… FullCalendar JS -->
	<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.8/index.global.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@6.1.8/index.global.min.js"></script>

	<!-- Custom JS -->
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			const calendarEl = document.getElementById('calendar');

			// FullCalendar ì´ˆê¸°í™”
			const calendar = new FullCalendar.Calendar(calendarEl, {
				initialView: 'dayGridMonth',
				locale: 'en', // ì˜ì–´ ì„¤ì •
				headerToolbar: false, // ê¸°ë³¸ í—¤ë” íˆ´ë°” ì œê±°
				dayHeaderContent: (args) => args.text.substr(0, 3), // ìš”ì¼ ì´ë¦„ì„ ì• ì„¸ ê¸€ìë¡œ í‘œì‹œ
				aspectRatio: 1.35, // ê¸°ì¡´ë³´ë‹¤ ë„“ì–´ì§€ê²Œ ì¡°ì •
				contentHeight: 'auto', // ìë™ ë†’ì´ ì¡°ì •
				dateClick: function(info) {
					// ì„ íƒí•œ ë‚ ì§œë¥¼ 'YYYY-MM-DD' í˜•ì‹ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸°
					const selectedDate = info.dateStr; // info.dateStrëŠ” ì„ íƒí•œ ë‚ ì§œë¥¼ ë¬¸ìì—´ë¡œ ë°˜í™˜
					console.log(selectedDate);
					// í•´ë‹¹ ë‚ ì§œë¡œ ì´ë™
					window.location.href = `/diary/${selectedDate}`;
				},
				events: [] // ì—¬ê¸°ì— ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
			});

			calendar.render();s

			// ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™”
			const yearSelect = document.getElementById('year-select');
			const monthSelect = document.getElementById('month-select');

			const currentYear = new Date().getFullYear();

			// ë…„ë„ ë“œë¡­ë‹¤ìš´ ì±„ìš°ê¸° (í˜„ì¬ ë…„ë„ ê¸°ì¤€ Â±5ë…„)
			for (let i = currentYear - 5; i <= currentYear + 5; i++) {
				const option = document.createElement('option');
				option.value = i;
				option.textContent = `${i} ë…„`;
				if (i === currentYear) option.selected = true; // í˜„ì¬ ë…„ë„ ì„ íƒ
				yearSelect.appendChild(option);
			}

			// ì›” ë“œë¡­ë‹¤ìš´ ì´ˆê¸°ê°’ ì„¤ì •
			monthSelect.value = new Date().getMonth();

			// ë“œë¡­ë‹¤ìš´ ë³€ê²½ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
			function updateCalendar() {
				const selectedYear = parseInt(yearSelect.value);
				const selectedMonth = parseInt(monthSelect.value);

				// ì„ íƒëœ ë…„ë„ì™€ ì›”ë¡œ ì´ë™
				calendar.gotoDate(new Date(selectedYear, selectedMonth));
			}

			yearSelect.addEventListener('change', updateCalendar);
			monthSelect.addEventListener('change', updateCalendar);
		});
	</script>
</th:block>
</body>
</html>
